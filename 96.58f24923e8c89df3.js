"use strict";(self.webpackChunksejMe=self.webpackChunksejMe||[]).push([[96],{8096:(Ut,U,n)=>{n.r(U),n.d(U,{CommitteeModule:()=>Mt});var t=n(5879),$=n(1993),d=n(1290),i=n(4221);const f=e=>e.committeesFilters,H=(0,i.P1)(f,e=>e.searchValue),b=(0,i.P1)(f,e=>e.selectedTerm),P=(0,i.P1)(f,e=>e.selectedTerm?.num||null),L=(0,i.P1)(f,e=>({searchValue:e.searchValue}));let V=(()=>{class e{constructor(){this.router=(0,t.f3M)(d.F0),this.store=(0,t.f3M)(i.yh),this.activeRoute=(0,t.f3M)(d.gz),this.destroyRef=(0,t.f3M)(t.ktI)}ngOnInit(){this.store.select(P).pipe((0,$.sL)(this.destroyRef)).subscribe(o=>{console.log("navigate",o),o&&this.router.navigate([],{relativeTo:this.activeRoute,queryParams:{term:o},queryParamsHandling:"merge"})})}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(s,m){1&s&&t._UZ(0,"router-outlet")},dependencies:[d.lC],encapsulation:2,changeDetection:0})}return e})(),D=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["sm-committee-details"]],decls:2,vars:0,template:function(s,m){1&s&&(t.TgZ(0,"p"),t._uU(1,"comittee-details works!"),t.qZA())},changeDetection:0})}return e})();var J=n(6208);const C=(0,i.PH)("[Committee] Load Committees List",(0,i.Ky)()),v=(0,i.PH)("[Committee] Load Committees List Success",(0,i.Ky)()),x=(0,i.PH)("[Committee] Load Committees List Error",(0,i.Ky)()),p=(0,i.PH)("[Committee] Filter Committees List",(0,i.Ky)()),w="committee",G=(0,i.Lq)({allCommittees:new Map,filteredCommittees:[],status:"pending",error:null},(0,i.on)(C,e=>({...e,status:"loading"})),(0,i.on)(v,(e,{committees:r})=>{const o=new Map;return r.forEach(s=>o.set(s.code,s)),{...e,allCommittees:o,filteredCommittees:r,error:null,status:"success"}}),(0,i.on)(x,(e,{error:r})=>({...e,error:r,status:"error"})),(0,i.on)(p,(e,{filters:r})=>{const o=function j(e,r){let o=[...e];if(r?.searchValue){const s=r.searchValue.toLocaleLowerCase();o=o.filter(m=>m.name.toLocaleLowerCase().includes(s)||m.code.toLocaleLowerCase().includes(s)||m.nameGenitive.toLocaleLowerCase().includes(s))}return console.log({filters:r,all:e.length,filtered:o.length}),o}(Array.from(e.allCommittees.values()),r);return{...e,filteredCommittees:o}}));function I(e,r){return G(e,r)}const F=(0,i.PH)("[CommitteesFilters] Initialize committees filters",(0,i.Ky)()),y=(0,i.PH)("[CommitteesFilters] Initialize selected term",(0,i.Ky)()),q=(0,i.PH)("[CommitteesFilters] Update selected term",(0,i.Ky)()),W=(0,i.PH)("[CommitteesFilters] Update selected term",(0,i.Ky)()),S=(0,i.PH)("[CommitteesFilters] Update search value",(0,i.Ky)()),z=(0,i.PH)("[CommitteesFilters] Save committee filters"),M=(0,i.PH)("[CommitteesFilters] Clear committee filters"),N={selectedTerm:null,searchValue:null},X=(0,i.Lq)(N,(0,i.on)(F,(e,r)=>({...e,...r})),(0,i.on)(y,(e,{term:r})=>(console.log("initializeCommitteeSelectedTerm",r),{...e,selectedTerm:r})),(0,i.on)(q,(e,{term:r})=>({...e,selectedTerm:r})),(0,i.on)(S,(e,{searchValue:r})=>({...e,searchValue:r})),(0,i.on)(M,()=>N));function _(e,r){return X(e,r)}var c=n(8131),l=n(2096),u=n(7634),O=n(7398),k=n(6306),B=n(9862),Y=n(2309);let tt=(()=>{class e{constructor(){this.apiPath="committees",this.http=(0,t.f3M)(B.eN),this.httpUtils=(0,t.f3M)(Y.O)}fetchList(o){return this.http.get(this.httpUtils.buildApiUrl(o,this.apiPath))}fetchByCode(o,s){return this.http.get(this.httpUtils.buildApiUrl(o,`${this.apiPath}/${s}`))}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),et=(()=>{class e{constructor(){this.store=(0,t.f3M)(i.yh),this.actions=(0,t.f3M)(c.eX),this.apiService=(0,t.f3M)(tt),this.loadCommitteeList$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(C),(0,u.z)(({termNum:o})=>this.apiService.fetchList(o).pipe((0,O.U)(s=>v({committees:s})),(0,k.K)(s=>(0,l.of)(x({error:s})))))))}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();const g=(0,i.ZF)(w),st=((0,i.P1)(g,e=>e.allCommittees),(0,i.P1)(g,e=>e.filteredCommittees));(0,i.P1)(g,e=>e.status),(0,i.P1)(g,e=>e.error);var T=n(6814),h=n(95);function ot(e,r){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA()()),2&e){const o=r.$implicit;t.xp6(2),t.Oqu(o.lastFirstName),t.xp6(2),t.Oqu(o.function),t.xp6(2),t.Oqu(o.club),t.xp6(2),t.Oqu(o.mandateExpired)}}let it=(()=>{class e{constructor(){this.members=[]}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["sm-committee-members"]],inputs:{members:"members"},decls:13,vars:1,consts:[[1,"table","table-xs","table-pin-rows","relative","max-h-full","w-full"],[4,"ngFor","ngForOf"]],template:function(s,m){1&s&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"Imi\u0119 i Nazwisko"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Funkcja"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Klub"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Wyga\u015bni\u0119cie mandatu"),t.qZA()()(),t.TgZ(11,"tbody"),t.YNc(12,ot,9,4,"tr",1),t.qZA()()),2&s&&(t.xp6(12),t.Q6J("ngForOf",m.members))},dependencies:[T.sg],changeDetection:0})}return e})();const rt=["membersModal"],mt=["sm-committee-row",""];let nt=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["tr","sm-committee-row",""]],viewQuery:function(s,m){if(1&s&&t.Gf(rt,5),2&s){let a;t.iGM(a=t.CRH())&&(m.membersModal=a.first)}},inputs:{committee:"committee",termNum:"termNum"},attrs:mt,decls:25,vars:8,consts:[[1,"flex","flex-col","gap-2"],[1,"btn","btn-neutral",3,"click"],[1,"modal"],["membersModal",""],[1,"modal-box","flex","flex-col","w-11/12","max-w-5xl","overflow-hidden"],[1,"font-bold","text-lg","modal-top"],[1,"overflow-y-scroll"],[3,"members"],["method","dialog",1,"modal-backdrop"]],template:function(s,m){if(1&s){const a=t.EpF();t.TgZ(0,"td"),t._uU(1),t.qZA(),t.TgZ(2,"td")(3,"div",0)(4,"span"),t._uU(5),t.qZA()()(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td")(13,"button",1),t.NdJ("click",function(){t.CHM(a);const At=t.MAs(16);return t.KtG(At.showModal())}),t._uU(14),t.qZA()(),t.TgZ(15,"dialog",2,3)(17,"div",4)(18,"h3",5),t._uU(19),t.qZA(),t.TgZ(20,"div",6),t._UZ(21,"sm-committee-members",7),t.qZA()(),t.TgZ(22,"form",8)(23,"button"),t._uU(24,"Zamknij"),t.qZA()()()}2&s&&(t.xp6(1),t.Oqu(m.committee.code),t.xp6(4),t.Oqu(m.committee.name),t.xp6(2),t.Oqu(m.committee.appointmentDate),t.xp6(2),t.Oqu(m.committee.compositionDate),t.xp6(2),t.Oqu(m.committee.scope),t.xp6(3),t.hij(" Poka\u017c (",m.committee.members.length,") "),t.xp6(5),t.hij(" Cz\u0142onkowie ",m.committee.nameGenitive," "),t.xp6(2),t.Q6J("members",m.committee.members))},dependencies:[h._Y,h.JL,h.F,it],changeDetection:0})}return e})();function ct(e,r){if(1&e&&(t._UZ(0,"tr",2),t.ALo(1,"async")),2&e){const o=r.$implicit,s=t.oxw();t.Q6J("committee",o)("termNum",t.lcZ(1,2,s.selectedTermNum$))}}const at=function(){return[]};let lt=(()=>{class e{constructor(){this.store=(0,t.f3M)(i.yh),this.committees$=this.store.select(st),this.selectedTermNum$=this.store.select(P)}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["sm-committee-table"]],decls:18,vars:4,consts:[[1,"table","table-xs","table-pin-rows","relative","max-h-full","w-full"],["sm-committee-row","",3,"committee","termNum",4,"ngFor","ngForOf"],["sm-committee-row","",3,"committee","termNum"]],template:function(s,m){1&s&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"Kod"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Nazwa"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Data desygnowania"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Data utworzenia"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Zakres"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Cz\u0142onkowie"),t.qZA()()(),t.TgZ(15,"tbody"),t.YNc(16,ct,2,4,"tr",1),t.ALo(17,"async"),t.qZA()()),2&s&&(t.xp6(16),t.Q6J("ngForOf",t.lcZ(17,1,m.committees$)||t.DdM(3,at)))},dependencies:[T.sg,nt,T.Ov],changeDetection:0})}return e})();var ut=n(9026),E=n(9788),ht=n(3751);const dt=function(){return[]};let pt=(()=>{class e{constructor(){this.store=(0,t.f3M)(i.yh),this.terms$=this.store.select(E.PB),this.selectedTerm$=this.store.select(b),this.searchValue$=this.store.select(H),this.compareTerms=ut.H}updateSelectedTerm(o){this.store.dispatch(W({term:o}))}updateSearchValue(o){this.store.dispatch(S({searchValue:o}))}saveFilters(){this.store.dispatch(z())}clearFilters(){this.store.dispatch(M())}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["sm-committee-filters"]],decls:14,vars:11,consts:[[1,"flex","gap-3"],["label","Wybierz kadencje sejmu","labelProperty","label",3,"items","ngModel","compareWithFn","ngModelChange"],[1,"form-control","max-w-xs"],["for","committee-search",1,"label-text","label"],["id","committee-search","type","text","placeholder","Szukaj po nazwie",1,"input","input-bordered","w-full","max-w-xs",3,"ngModel","ngModelChange"],[1,"flex","items-end","flex-1","gap-1"],[1,"btn","btn-neutral",3,"click"],[1,"btn",3,"click"]],template:function(s,m){1&s&&(t.TgZ(0,"div",0)(1,"sm-item-select",1),t.NdJ("ngModelChange",function(Z){return m.updateSelectedTerm(Z)}),t.ALo(2,"async"),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",2)(5,"label",3),t._uU(6," Nazwa komisji "),t.qZA(),t.TgZ(7,"input",4),t.NdJ("ngModelChange",function(Z){return m.updateSearchValue(Z)}),t.ALo(8,"async"),t.qZA()(),t.TgZ(9,"div",5)(10,"button",6),t.NdJ("click",function(){return m.saveFilters()}),t._uU(11,"Filtruj"),t.qZA(),t.TgZ(12,"button",7),t.NdJ("click",function(){return m.clearFilters()}),t._uU(13,"Usu\u0144 filtry"),t.qZA()()()),2&s&&(t.xp6(1),t.Q6J("items",t.lcZ(2,4,m.terms$)||t.DdM(10,dt))("ngModel",t.lcZ(3,6,m.selectedTerm$))("compareWithFn",m.compareTerms),t.xp6(6),t.Q6J("ngModel",t.lcZ(8,8,m.searchValue$)))},dependencies:[ht.p,h.Fj,h.JJ,h.On,T.Ov],changeDetection:0})}return e})(),ft=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["sm-committee-list-page"]],decls:4,vars:0,consts:[[1,"px-4","py-4"],[1,"my-4"],[1,"overflow-x-auto","block"]],template:function(s,m){1&s&&(t.TgZ(0,"main",0),t._UZ(1,"sm-committee-filters")(2,"hr",1)(3,"sm-committee-table",2),t.qZA())},dependencies:[lt,pt],changeDetection:0})}return e})();var Ct=n(1374),gt=n(6503),R=n(6232),A=n(2460);function vt(e){return{search:e.searchValue||void 0}}let Ft=(()=>{class e{constructor(){this.store=(0,t.f3M)(i.yh),this.actions=(0,t.f3M)(c.eX),this.router=(0,t.f3M)(d.F0),this.activatedRoute=(0,t.f3M)(d.gz),this.filtersInitialize$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(F),(0,u.z)(o=>(0,l.of)(p({filters:o}))))),this.selectedTermInitialize$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(y),(0,u.z)(({term:o})=>o?(0,l.of)(C({termNum:o.num})):R.E))),this.filterMembersOnLoadSuccess$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(v),(0,A.M)(this.store.select(L)),(0,u.z)(([o,s])=>(0,l.of)(p({filters:s}))))),this.termFilterUpdate$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(q),(0,u.z)(({term:o})=>o?(this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{term:o.num},queryParamsHandling:"merge"}),(0,l.of)(C({termNum:o.num}))):R.E))),this.filtersSaved$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(z),(0,A.M)(this.store.select(L)),(0,u.z)(([o,s])=>(this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{...vt(s)},queryParamsHandling:"merge"}),(0,l.of)(p({filters:s})))))),this.filtersCleared$=(0,c.GW)(()=>this.actions.pipe((0,c.l4)(M),(0,A.M)(this.store.select(b)),(0,u.z)(([o,s])=>(this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:s?{term:s.num}:{}}),(0,l.of)(p({}))))))}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();const yt=[{path:"",component:V,resolve:{committeeFilters:e=>{const r=(0,t.f3M)(i.yh),o=function Tt(e){return{searchValue:e.search}}(e.queryParams);return r.select(E.PB).pipe((0,Ct.P)(),(0,O.U)(s=>(r.dispatch(F(o)),r.dispatch(y({term:(0,gt.w)(s,e.queryParams)})),o)))}},children:[{path:"",component:ft},{path:":id",component:D}]}];let Mt=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[J.m,h.u5,d.Bz.forChild(yt),i.Aw.forFeature(w,I),i.Aw.forFeature("committeesFilters",_),c.sQ.forFeature([et,Ft])]})}return e})()}}]);